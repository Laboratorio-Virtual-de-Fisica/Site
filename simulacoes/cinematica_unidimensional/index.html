<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulador de Cinemática 1D</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: sans-serif;
        background: #f5f5f5;
        padding: 2rem;
        margin: 0;
        color: #333;
      }
      h1 {
        font-size: 1.5rem;
        margin-bottom: 1rem;
      }
      .container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }
      .inputs,
      .controls {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
      }
      label {
        display: flex;
        flex-direction: column;
        font-size: 0.9rem;
      }
      input[type="number"] {
        padding: 0.25rem;
        border: 1px solid #ccc;
        border-radius: 4px;
        width: 6rem;
      }
      button {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 4px;
        background: #333;
        color: white;
        cursor: pointer;
      }
      canvas {
        background: white;
        border: 1px solid #ccc;
        padding: 1rem;
      }
      #animation {
        height: 60px;
        position: relative;
        background: #e0e0e0;
        overflow: hidden;
        border-radius: 4px;
      }
      #object {
        position: absolute;
        top: 10px;
        width: 40px;
        height: 40px;
        background: #333;
        border-radius: 50%;
      }
    </style>
  </head>
  <body>
    <h1>Simulador de Cinemática Unidimensional</h1>
    <div class="container">
      <div class="inputs">
        <label>
          Posição Inicial (m)
          <input type="number" id="posicao" value="0" />
        </label>
        <label>
          Velocidade Inicial (m/s)
          <input type="number" id="velocidade" value="2" />
        </label>
        <label>
          Aceleração (m/s²)
          <input type="number" id="aceleracao" value="0" />
        </label>
        <label>
          Duração (s)
          <input type="number" id="duracao" value="10" />
        </label>
      </div>
      <div class="controls">
        <button onclick="iniciarSimulacao()">Iniciar</button>
        <button onclick="pausarSimulacao()" id="pauseBtn" disabled>
          Pausar
        </button>
        <button onclick="reiniciar()">Reiniciar</button>
      </div>
      <div id="animation">
        <div id="object"></div>
      </div>
      <canvas id="grafico"></canvas>
    </div>

    <script>
      const obj = document.getElementById("object");
      const grafico = document.getElementById("grafico");
      const pauseBtn = document.getElementById("pauseBtn");
      let chart;
      let intervalo;
      let pausado = false;

      // variáveis persistentes entre pausas
      let tempo = [];
      let posicoes = [];
      let velocidades = [];
      let aceleracoes = [];
      let t = 0;
      let dt = 0.1;
      let duracao, s0, v0, a;

      function iniciarSimulacao() {
        s0 = parseFloat(document.getElementById("posicao").value);
        v0 = parseFloat(document.getElementById("velocidade").value);
        a = parseFloat(document.getElementById("aceleracao").value);
        duracao = parseFloat(document.getElementById("duracao").value);

        // resetar variáveis
        tempo = [];
        posicoes = [];
        velocidades = [];
        aceleracoes = [];
        t = 0;

        clearInterval(intervalo);
        obj.style.left = "0px";
        pauseBtn.disabled = false;
        pauseBtn.textContent = "Pausar";
        pausado = false;

        if (chart) chart.destroy();
        chart = new Chart(grafico, {
          type: "line",
          data: {
            labels: tempo,
            datasets: [
              {
                label: "Posição (m)",
                data: posicoes,
                borderColor: "#1f77b4",
                fill: false,
              },
              {
                label: "Velocidade (m/s)",
                data: velocidades,
                borderColor: "#2ca02c",
                fill: false,
              },
              {
                label: "Aceleração (m/s²)",
                data: aceleracoes,
                borderColor: "#d62728",
                fill: false,
              },
            ],
          },
          options: {
            animation: false,
            responsive: true,
            scales: {
              y: {
                beginAtZero: false,
              },
            },
          },
        });

        rodarSimulacao();
      }

      function rodarSimulacao() {
        intervalo = setInterval(() => {
          if (t > duracao) {
            clearInterval(intervalo);
            pauseBtn.disabled = true;
            return;
          }

          const s = s0 + v0 * t + 0.5 * a * t * t;
          const v = v0 + a * t;

          tempo.push(t.toFixed(1));
          posicoes.push(s.toFixed(2));
          velocidades.push(v.toFixed(2));
          aceleracoes.push(a);

          obj.style.left = `${s * 10}px`;

          chart.data.labels = tempo;
          chart.data.datasets[0].data = posicoes;
          chart.data.datasets[1].data = velocidades;
          chart.data.datasets[2].data = aceleracoes;
          chart.update();

          t += dt;
        }, 100);
      }

      function pausarSimulacao() {
        if (!pausado) {
          clearInterval(intervalo);
          pausado = true;
          pauseBtn.textContent = "Continuar";
        } else {
          pausado = false;
          pauseBtn.textContent = "Pausar";
          rodarSimulacao();
        }
      }

      function reiniciar() {
        clearInterval(intervalo);
        obj.style.left = "0px";
        if (chart) chart.destroy();
        pauseBtn.disabled = true;
        pauseBtn.textContent = "Pausar";
        pausado = false;
        t = 0;
      }
    </script>
  </body>
</html>
